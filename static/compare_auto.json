{
  "openapi": "3.0.0",
  "info": {
    "title": "PCB Compare Tool",
    "description": "用于检测学生上传的 PCB 图片与标准板的差异区域，可上传文件或提供图片链接。",
    "version": "1.0.0"
  },
  "paths": {
    "/compare_auto": {
      "post": {
        "summary": "自动比对 PCB 差异",
        "description": "上传学生电路板图片或图片链接，自动与标准板对比，返回差异标记图和相似度得分。",
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "image": {
                    "type": "string",
                    "format": "binary",
                    "description": "学生上传的电路板图片（文件）"
                  }
                },
                "required": ["image"]
              }
            },
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "image": {
                    "type": "string",
                    "description": "学生上传的电路板图片链接（URL）"
                  }
                },
                "required": ["image"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "比对结果（含差异图与坐标）",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "similarity": {
                      "type": "number",
                      "description": "两张图片的相似度得分（0~1）"
                    },
                    "diff_coordinates": {
                      "type": "array",
                      "description": "差异区域的矩形坐标",
                      "items": {
                        "type": "object",
                        "properties": {
                          "x": { "type": "integer" },
                          "y": { "type": "integer" },
                          "w": { "type": "integer" },
                          "h": { "type": "integer" }
                        }
                      }
                    },
                    "result_image_base64": {
                      "type": "string",
                      "description": "标记差异后的图片（Base64 编码）"
                    },
                    "standard_used": {
                      "type": "string",
                      "description": "使用的标准电路板文件名"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "请求错误，如缺少图片或下载失败",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": { "type": "string" }
                  }
                }
              }
            }
          },
          "500": {
            "description": "服务器内部错误",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}



